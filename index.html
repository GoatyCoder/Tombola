<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tombola Nojana</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
    <script defer src="script.js"></script>
  </head>
  <body>
    <!-- Skip Link -->
    <a class="skip-link" href="#main-content">Salta al contenuto principale</a>

    <!-- Header -->
    <header class="hero" role="banner">
      <div class="shell hero__shell">
        <div class="hero__brand">
          <div class="hero__presenter-group" aria-label="Amici del Teatro presenta">
            <span class="hero__presenter-logo">
              <img src="images/logo_amicidelteatro.svg" alt="" loading="lazy" decoding="async" />
            </span>
            <span class="hero__presenter">presenta</span>
          </div>
          <h1 class="hero__title">La Tombola Nojana</h1>
        </div>
        <p class="hero__lead">
          Il tabellone digitale per vivere la tombolata in vernacolo nojano in modo interattivo.
        </p>
      </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="layout" aria-label="Applicazione Tombola Nojana">
      
      <!-- Dashboard Section -->
      <section class="layout__section layout__section--dashboard" aria-labelledby="dashboard-heading">
        <div class="shell dashboard__shell">
          <h2 id="dashboard-heading" class="sr-only">Controllo estrazioni</h2>
          
          <div class="dashboard__grid">
            <article class="status-card status-card--overview" aria-labelledby="draw-overview-heading">
              <h3 id="draw-overview-heading" class="sr-only">Ultimo numero e stato delle estrazioni</h3>
              
              <!-- Summary Metrics -->
              <div class="status-card__summary">
                <div class="status-card__metric status-card__metric--last" role="status" aria-live="polite">
                  <p class="status-card__label">Ultimo numero</p>
                  <p id="draw-last-number" class="status-card__value" aria-atomic="true">—</p>
                  <p id="draw-last-detail" class="status-card__detail">In attesa della prima estrazione</p>
                </div>
                
                <div class="status-card__metric status-card__metric--progress" role="group" aria-labelledby="progress-label">
                  <p id="progress-label" class="status-card__label sr-only">Numeri estratti</p>
                  <p id="draw-progress-value" class="status-card__value status-card__value--compact">0/0</p>
                  <div id="draw-progress-bar" class="progress" role="progressbar" aria-valuemin="0" aria-valuemax="0" aria-valuenow="0">
                    <span id="draw-progress-fill" class="progress__fill"></span>
                  </div>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="status-card__actions">
                <button type="button" id="draw-button" class="button button--dashboard button--primary" disabled>
                  <span class="button__label">Estrai numero</span>
                  <img src="images/icon-die.svg" class="button__icon die-icon" alt="" aria-hidden="true" />
                </button>
                
                <button type="button" id="reset-button" class="button button--dashboard button--icon" aria-label="Reset partita" disabled>
                  <svg viewBox="0 0 24 24" aria-hidden="true" class="button__icon">
                    <path d="M6 7.5A6.75 6.75 0 0 1 18.32 9" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M18 4.5v4.25h-4.25" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M18 16.5a6.75 6.75 0 0 1-12.32-1.5" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M6 19.5V15.25h4.25" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
                
                <button type="button" id="history-toggle" class="button button--dashboard button--icon" 
                        aria-expanded="false" aria-controls="history-panel" aria-label="Cronologia">
                  <svg class="button__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M5.75 4.5h12.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H5.75a.75.75 0 0 1-.75-.75V5.25a.75.75 0 0 1 .75-.75Z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M8 7h8m-8 4h8m-8 4h5" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
              </div>
            </article>
          </div>
        </div>
      </section>

      <!-- Board Section -->
      <section class="layout__section layout__section--board" aria-labelledby="board-heading">
        <div class="shell board-area__shell">
          <div class="board-area__layout">
            
            <!-- Board -->
            <article class="board-wrapper">
              <div class="board-head">
                <h2 id="board-heading" class="board-head__title">Tabellone</h2>
                <span id="draw-status" class="sr-only">Caricamento del tabellone…</span>
              </div>
              <div class="board-grid" id="board" aria-live="polite"></div>
            </article>

            <!-- History Panel -->
            <aside id="history-panel" class="history" aria-label="Cronologia estrazioni" hidden>
              <header class="history__header">
                <h3 class="history__title">Cronologia</h3>
                <p class="history__subtitle">L'ordine completo delle estrazioni.</p>
              </header>
              <p class="history__empty" id="draw-history-empty">Nessun numero estratto finora.</p>
              <ol class="history__list" id="draw-history" aria-live="polite"></ol>
            </aside>
          </div>

          <!-- Floating Action Buttons -->
          <div class="board-area__floating">
            <div class="fab-group">
              <button type="button" id="floating-draw-button" class="fab fab--primary" aria-label="Estrai numero" disabled>
                <img src="images/icon-die.svg" class="fab__icon die-icon" alt="" aria-hidden="true" />
              </button>
              
              <button type="button" id="audio-toggle" class="fab fab--secondary audio-fab" 
                      aria-pressed="true" aria-label="Disattiva annuncio audio">
                <svg class="audio-fab__icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path class="audio-fab__speaker" d="M5.5 9.5H8l3.5-3.5v12L8 14.5H5.5a1.5 1.5 0 0 1-1.5-1.5v-2a1.5 1.5 0 0 1 1.5-1.5Z" />
                  <path class="audio-fab__wave" d="M15.5 9.5a3 3 0 0 1 0 5" />
                  <path class="audio-fab__wave audio-fab__wave--strong" d="M17.8 7.8a6 6 0 0 1 0 8.5" />
                  <path class="audio-fab__cross" d="M16 9l5 5m0-5-5 5" />
                </svg>
              </button>
            </div>
          </div>
        </div>
        
        <!-- History Scrim -->
        <div id="history-scrim" class="scrim" hidden></div>
      </section>

      <!-- Sponsor Showcase Section -->
      <section class="layout__section layout__section--sponsor sponsor" id="sponsor-showcase" hidden>
        <div class="shell sponsor__shell">
          <header class="sponsor__header">
            <p class="sponsor__eyebrow">Sponsor e partner</p>
          </header>
          <ul class="sponsor__grid" id="sponsor-showcase-list" aria-label="Elenco sponsor">
            <!-- Dinamicamente popolato con:
            <li class="sponsor__grid-item">
              <div class="sponsor-card sponsor-card--showcase">
                <a class="sponsor-card__link" href="#" target="_blank" rel="noopener noreferrer">
                  <figure class="sponsor-card__figure">
                    <span class="sponsor-card__logo">
                      <img src="..." alt="" loading="lazy" decoding="async" />
                    </span>
                  </figure>
                </a>
              </div>
            </li>
            -->
          </ul>
        </div>
      </section>
    </main>

    <!-- Draw Animation Portal -->
    <div id="draw-portal" class="draw-portal" hidden>
      <div class="draw-portal__scrim"></div>
      <div class="sr-only" id="draw-animation-announcement" aria-live="assertive"></div>
      
      <div class="draw-portal__content" role="status" aria-live="assertive">
        <div class="draw-portal__ball token" id="draw-animation-ball">
          <span class="draw-portal__loader" id="draw-portal-loader">
            <span class="draw-portal__loader-dot"></span>
            <span class="draw-portal__loader-dot"></span>
            <span class="draw-portal__loader-dot"></span>
          </span>
          <span id="draw-animation-number" class="draw-portal__number token__number"></span>
        </div>
      </div>

      <!-- Draw Animation Portal - Sponsor Block -->
      <div id="draw-sponsor-block" class="sponsor-card sponsor-card--overlay" hidden>
        <p id="draw-sponsor-heading" class="sponsor-card__label">Sponsor dell'estrazione</p>
        <a id="draw-sponsor" class="sponsor-card__link" href="#" target="_blank" rel="noopener noreferrer">
          <figure class="sponsor-card__figure">
            <span class="sponsor-card__logo">
              <img id="draw-sponsor-logo" alt="" decoding="async" />
            </span>
          </figure>
        </a>
      </div>
    </div>

    <!-- Reset Confirmation Dialog -->
    <div id="reset-dialog" class="modal" role="dialog" aria-modal="true" 
         aria-labelledby="reset-dialog-title" aria-describedby="reset-dialog-message" hidden>
      <div class="confirm-dialog">
        <h2 id="reset-dialog-title" class="confirm-dialog__title">Azzerare la partita?</h2>
        <p id="reset-dialog-message" class="confirm-dialog__message">
          Tutti i numeri estratti e la cronologia verranno cancellati.
        </p>
        <div class="confirm-dialog__actions">
          <button type="button" class="button" data-reset-cancel>Continua a giocare</button>
          <button type="button" class="button button--primary" data-reset-confirm>Azzera tabellone</button>
        </div>
      </div>
    </div>

    <!-- Number Detail Modal -->
    <div id="number-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-number" hidden>
      <div class="number-dialog">
        <header class="number-dialog__header">
          <p id="modal-number" class="number-dialog__headline" aria-live="polite"></p>
          <div class="number-dialog__header-actions">
            <button type="button" class="number-dialog__next" id="modal-next" aria-label="Estrai successivo" hidden disabled>
              <span class="number-dialog__next-label">Estrai successivo</span>
              <img src="images/icon-die.svg" class="die-icon" alt="" aria-hidden="true" />
            </button>
            <button type="button" class="number-dialog__close" id="modal-close" aria-label="Chiudi">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
        </header>

        <div class="number-dialog__body">
          <div class="number-dialog__visual">
            <div class="number-dialog__image-frame" id="modal-image-frame">
              <img id="modal-image" alt="" decoding="async" loading="lazy" />
            </div>
          </div>

          <div class="number-dialog__details">
            <div class="number-dialog__languages">
              <!-- Dialect Card -->
              <article class="number-dialog__language-card number-dialog__language-card--dialect">
                <header class="number-dialog__language-header">
                  <span class="number-dialog__language-emblem">
                    <img src="images/logo_noicattaro.svg" alt="" loading="lazy" decoding="async" />
                  </span>
                  <span class="number-dialog__language-name">Nojano</span>
                  <button type="button" class="number-dialog__audio-button" id="modal-dialect-play" 
                          aria-describedby="modal-dialect" aria-label="Riproduci la pronuncia in nojano">
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                      <circle cx="12" cy="12" r="8.75" fill="none" stroke="currentColor" stroke-width="1.5" />
                      <path d="M10 8.5v7l5-3.5-5-3.5Z" fill="currentColor" />
                    </svg>
                  </button>
                </header>
                <p id="modal-dialect" class="number-dialog__phrase"></p>
              </article>

              <!-- Italian Card -->
              <article class="number-dialog__language-card number-dialog__language-card--italian">
                <header class="number-dialog__language-header">
                  <span class="number-dialog__language-emblem">
                    <img src="images/logo_italia.svg" alt="" loading="lazy" decoding="async" />
                  </span>
                  <span class="number-dialog__language-name">Italiano</span>
                  <button type="button" class="number-dialog__audio-button" id="modal-italian-play" 
                          aria-describedby="modal-italian" aria-label="Riproduci la pronuncia in italiano">
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                      <circle cx="12" cy="12" r="8.75" fill="none" stroke="currentColor" stroke-width="1.5" />
                      <path d="M10 8.5v7l5-3.5-5-3.5Z" fill="currentColor" />
                    </svg>
                  </button>
                </header>
                <p id="modal-italian" class="number-dialog__phrase"></p>
              </article>
            </div>

            <!-- Number Detail Modal - Sponsor Block -->
            <footer class="number-dialog__footer">
              <div id="modal-sponsor-block" class="sponsor-card sponsor-card--modal" hidden>
                <a id="modal-sponsor" class="sponsor-card__link" href="#" target="_blank" rel="noopener noreferrer">
                  <figure class="sponsor-card__figure">
                    <span class="sponsor-card__logo">
                      <img id="modal-sponsor-logo" alt="" decoding="async" loading="lazy" />
                    </span>
                  </figure>
                </a>
              </div>
            </footer>
          </div>
        </div>
      </div>
    </div>

    <!-- Board Cell Template -->
    <template id="board-cell-template">
      <button class="board-cell" type="button">
        <img class="board-cell__media" alt="" aria-hidden="true" loading="lazy" decoding="async" />
        <span class="board-cell__token token" aria-hidden="true">
          <span class="board-cell__token-number token__number"></span>
        </span>
        <span class="sr-only"></span>
      </button>
    </template>

    <!-- Footer -->
    <footer class="app-footer" role="contentinfo">
        <div class="app-footer__bottom">
          <div class="app-footer__meta">
            <a class="app-footer__association" href="https://www.amicidelteatro.it/" target="_blank" rel="noopener noreferrer">
              <img src="images/logo_amicidelteatro_big.svg" alt="Associazione Culturale Nojana Amici del Teatro" 
                 class="app-footer__association-logo" loading="lazy" decoding="async" />
            </a>
            <p class="app-footer__credits">
              <span class="app-footer__credits-contact">info@amicidelteatro.it · C.F. 93189030724</span>
            </p>
            
            <nav class="app-footer__links" aria-label="Collegamenti legali">
              <a href="https://www.amicidelteatro.it/privacy-policy.html" target="_blank" rel="noopener noreferrer">Privacy Policy</a>
              <span class="app-footer__separator" aria-hidden="true">•</span>
              <a href="https://www.amicidelteatro.it/cookie-policy.html" target="_blank" rel="noopener noreferrer">Cookie Policy</a>
            </nav>
            
            <p class="app-footer__disclaimer">
              Questa applicazione salva i dati di gioco solo localmente sul tuo dispositivo e non raccoglie informazioni personali.
            </p>
            
            <div class="app-footer__powered">
              <span class="app-footer__powered-label">Powered by</span>
              <a class="app-footer__powered-link" href="mailto:GoatyCoder@proton.me" aria-label="GoatyCoder">
                <img src="images/logo_goatycoder.svg" alt="GoatyCoder" class="app-footer__powered-logo" 
                     decoding="async" loading="lazy" />
              </a>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
